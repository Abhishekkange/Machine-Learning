<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Guess the Actor</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen flex flex-col items-center p-6">
    <div class="w-full max-w-2xl">
        <h1 class="text-4xl font-bold text-center mb-6 text-indigo-600">ðŸŽ¬ Guess the Actor</h1>

        <!-- Supported Actors -->
        <div id="actorInfo" class="bg-white shadow-md rounded-lg p-4 mb-6 text-gray-700 text-center">
            Loading supported actors...
        </div>

        <!-- Game Card -->
        <div id="game" class="bg-white shadow-lg rounded-xl p-6">
            <div id="questionBox" class="text-xl font-semibold mb-4 text-center hidden"></div>
            <div id="options" class="flex flex-col md:flex-row justify-center gap-4"></div>
            <div id="result" class="text-green-600 text-2xl font-bold mt-4 text-center"></div>
        </div>
    </div>

    <script>
        let treeData = null;
        let actorsList = [];
        let currentNodeId = null;

        async function loadTree() {
            const res = await fetch('actor_tree.json');
            treeData = await res.json();
        }

        async function loadActorsInfo() {
            const res = await fetch('actors.json');
            actorsList = await res.json();
            const infoDiv = document.getElementById('actorInfo');

            // Display actors in a nice grid
            infoDiv.innerHTML = `
                ðŸŽ¯ Our game supports these actors. You can guess from these only:
                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 mt-2 text-indigo-700 font-medium">
                    ${actorsList.map(actor => `<span class="px-2 py-1 bg-indigo-100 rounded">${actor}</span>`).join('')}
                </div>`;
        }

        function showNode(nodeId) {
            const node = treeData.nodes[nodeId];
            const qBox = document.getElementById('questionBox');
            const options = document.getElementById('options');
            const result = document.getElementById('result');

            result.textContent = '';
            options.innerHTML = '';
            qBox.classList.remove('hidden');

            if (node.type === 'leaf') {
                qBox.textContent = `ðŸŽ¯ I guess: ${node.predicted_class}`;
                const info = document.createElement('div');
                info.textContent = 'Samples: ' + node.samples;
                info.className = 'text-center mt-2 text-gray-600';
                options.appendChild(info);

                const restart = document.createElement('button');
                restart.className = 'mt-4 px-6 py-2 bg-indigo-600 text-white rounded shadow hover:bg-indigo-700 transition';
                restart.textContent = 'Play Again';
                restart.onclick = () => location.reload();
                options.appendChild(restart);
                return;
            }

            qBox.textContent = node.question;

            const leftBtn = document.createElement('button');
            leftBtn.className = 'px-6 py-2 bg-indigo-500 text-white rounded shadow hover:bg-indigo-600 transition';
            leftBtn.textContent = node.left_label;
            leftBtn.onclick = () => { currentNodeId = node.left; showNode(String(currentNodeId)); };

            const rightBtn = document.createElement('button');
            rightBtn.className = 'px-6 py-2 bg-green-500 text-white rounded shadow hover:bg-green-600 transition';
            rightBtn.textContent = node.right_label;
            rightBtn.onclick = () => { currentNodeId = node.right; showNode(String(currentNodeId)); };

            options.appendChild(leftBtn);
            options.appendChild(rightBtn);
        }

        (async function () {
            await loadActorsInfo();
            await loadTree();

            document.getElementById('questionBox').classList.remove('hidden');
            currentNodeId = String(treeData.root);
            showNode(currentNodeId);
        })();
    </script>
</body>

</html>